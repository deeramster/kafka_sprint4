# Кластер Apache Kafka с SSL и ACL

Этот проект настраивает защищенный кластер Apache Kafka из трех брокеров с использованием SSL для шифрования и аутентификации, а также ACL для контроля доступа.

## Структура проекта

```
.
├── config/                     # Конфигурационные файлы брокеров
│   ├── server-broker1.properties
│   ├── server-broker2.properties
│   └── server-broker3.properties
├── secrets/                    # Сертификаты и ключи (создаются скриптом)
│   ├── ca/                     # Корневой CA
│   ├── broker1/                # Ключи и сертификаты для брокера 1
│   ├── broker2/                # Ключи и сертификаты для брокера 2
│   ├── broker3/                # Ключи и сертификаты для брокера 3
│   └── client/                 # Ключи и сертификаты для клиентов
├── docker-compose.yml          # Конфигурация Docker Compose
├── generate-certs.sh           # Скрипт для генерации сертификатов
├── setup-topics.sh             # Скрипт для создания топиков и настройки ACL
├── producer.sh                 # Скрипт для отправки сообщений
├── consumer.sh                 # Скрипт для чтения сообщений
└── run-project.sh              # Основной скрипт для запуска проекта
```

## Топики и доступ

1. **topic-1**: Доступен для чтения и записи
2. **topic-2**: Доступен только для записи (чтение запрещено)

## Запуск проекта

1. Клонируйте репозиторий
2. Сделайте скрипты исполняемыми:
   ```bash
   chmod +x *.sh
   ```
3. Запустите проект:
   ```bash
   ./run-project.sh
   ```

## Тестирование

После запуска вы можете проверить функциональность с помощью следующих команд:

1. Отправка сообщений в первый топик:
   ```bash
   ./producer.sh topic-1
   ```

2. Чтение сообщений из первого топика:
   ```bash
   ./consumer.sh topic-1
   ```

3. Отправка сообщений во второй топик:
   ```bash
   ./producer.sh topic-2
   ```

4. Попытка чтения из второго топика (должна завершиться с ошибкой доступа):
   ```bash
   ./consumer.sh topic-2
   ```

## Требования

- Docker и Docker Compose
- OpenSSL
- Java/keytool (для работы с сертификатами)

## Примечания

- Все пароли установлены как `test1234` для упрощения примера. В реальном проекте используйте надежные пароли
- При перезапуске проекта все данные в топиках будут потеряны, так как не настроены постоянные тома
